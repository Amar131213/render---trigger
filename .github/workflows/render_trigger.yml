name: Trigger Render Daily

on:
  schedule:
    - cron: '30 11 * * 1-5'  # à¤¸à¥‹à¤®à¤µà¤¾à¤° à¤¸à¥‡ à¤¶à¥à¤•à¥à¤°à¤µà¤¾à¤°, à¤¶à¤¾à¤® 5:00 à¤¬à¤œà¥‡ IST
  workflow_dispatch:

jobs:
  trigger_render:
    runs-on: ubuntu-latest
    steps:
      - name: Install jq (JSON parser)
        run: sudo apt-get install jq

      - name: Trigger Render Webhook and wait for correct response
        run: |
          echo "ğŸ”ƒ Calling /run endpoint..."
          response=$(curl -s "https://screener-scraper.onrender.com/run")

          echo "ğŸ” Response received: $response"

          status=$(echo "$response" | jq -r '.status')

          if [ "$status" = "ğŸŸ¢ Scraper started in background." ]; then
            echo "âœ… Scraper has started successfully!"
          else
            echo "âŒ Unexpected response. Status: $status"
            exit 1
          fi
