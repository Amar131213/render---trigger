name: Trigger Render Daily

on:
  schedule:
    - cron: '30 11 * * 1-5'  # ‡§∏‡•ã‡§Æ‡§µ‡§æ‡§∞ ‡§∏‡•á ‡§∂‡•Å‡§ï‡•ç‡§∞‡§µ‡§æ‡§∞, ‡§∂‡§æ‡§Æ 5 ‡§¨‡§ú‡•á IST
  workflow_dispatch:

jobs:
  trigger_render:
    runs-on: ubuntu-latest
    steps:
      - name: Call Render and Wait for Exact Response
        run: |
          echo "Calling Render /run endpoint..."
          RESPONSE=$(curl -s --max-time 90 "https://screener-scraper.onrender.com/run")
          echo "Response received: $RESPONSE"

          EXPECTED='{"status":"üü¢ Scraper started in background."}'

          if [[ "$RESPONSE" == "$EXPECTED" ]]; then
            echo "‚úÖ Expected response received."
          else
            echo "‚ùå Unexpected response. Exiting with error."
            exit 1
          fi
